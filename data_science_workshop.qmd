---
title: "Data Science Workshop Session 3"
subtitle: 'MSc in Statistics 2025/26, Imperial College London'
author: "Claire Sibbald"
format:
  html:
    toc: true
    highlight: tango
    self-contained: true
  pdf: default
format-links: false
bibliography: ref.bib
---
```{r include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(palmerpenguins)
library(ggplot2)
library(dplyr)
library(knitr)
```
## The data
The data we are working with comes from the Palmer Penguins data set \parencite{palmerpenguins}. The following is a sample of the data:
```{r echo=FALSE}
kable(head(penguins), caption='Table 1. Penguins dataset',
      col.names=c('Species', 'Island', 'Bill Length (mm)', 'Bill Depth (mm)', 
                  'Flipper Length (mm)', 'Body Mass (g)', 'Sex', 'Year'))
```

## Bill length and flipper length
We are interested in comparing the bill length and flipper length between the different species of penguins. The mean of each measure between species is summarised in Table 2.
```{r echo=FALSE}
mean_dat = penguins |>
  group_by(species) |>
  summarise(mean_bill_length = mean(bill_length_mm, na.rm=TRUE),
            mean_flipper_length = mean(flipper_length_mm, na.rm=TRUE))

kable(mean_dat, caption='Table 2. Means Data',
      col.names=c('Species', 'Mean Bill Length (mm)', 
                  'Mean Flipper Length (mm)'))
```


Flipper length and body mass appear to be linearly correlated across penguin species (Figure 1). The mean value for each species is plotted in black.

```{r echo=FALSE}
caption = 'Data source: palmerpenguins'
mean_df = penguins |>
  group_by(species) |>
  summarise(mean_flipper_length_mm = mean(flipper_length_mm, na.rm=TRUE),
            mean_body_mass_g = mean(body_mass_g, na.rm=TRUE))

ggplot(penguins, aes(x=body_mass_g, 
                     y=flipper_length_mm, shape=species)) +
  geom_point(aes(colour=species)) +
  geom_point(data=mean_df, 
             aes(y=mean_flipper_length_mm, x=mean_body_mass_g), 
             size=3) +
  theme_classic() +
  labs(x='Body Mass (g)', y='Flipper Length (mm)', 
       shape='Species', colour='Species', caption=caption, 
       title='Flipper Length vs Body Mass') +
  theme(plot.caption = element_text(colour='blue'),
        plot.title = element_text(size=15, hjust=0.5))
```

## Code Appendix
```{r ref.label=knitr::all_labels(), echo = T, eval = F}
```


